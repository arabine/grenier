5 CLEAR ,,2000
10 CLS:KEY OFF:SCREEN 1:RANDOMIZE TIMER
20 LOCATE 1,10:PRINT "-----PUISSANCE 4-----":LOCATE 6,1:PRINT "Quit":PRINT:PRINT "Erase":PRINT:PRINT "1 PLAY":PRINT:PRINT "2 PLAY"
30 LINE (54,34)-(266,199),3,BF
40 FOR J=49 TO 184 STEP 27:FOR I=70 TO 256 STEP 30
50 CIRCLE (I,J),12.5,0:PAINT (I,J),0,0:NEXT I,J
60 DIM T(7,6),A(60),B(60)
70 CIRCLE (15,15),12.5,1:PAINT (15,15),1,1:GET (1,1)-(30,30),A
80 CIRCLE (15,15),12.5,2:PAINT (15,15),2,2:GET (1,1)-(30,30),B
90 X=9:I=1:J=1:E=1:R=1:G=INT(RND*2):IF G=1 THEN 110
100 PUT (1,1),A,PSET
105 GOSUB 760:IF GG>=4 THEN BEEP:PRINT "LES ROUGES GAGNENT!":END
106 GOTO 120
110 PUT (1,1),B,PSET
115 GOSUB 520:IF GG>=4 THEN BEEP:PRINT "LES BLEUS GAGNENT!":END
120 LOCATE 4,X:PRINT CHR$(25):Z=X
130 R$=INKEY$:IF R$="Q" OR R$="q" THEN END ELSE IF R$="E" OR R$="e" THEN 210 ELSE IF R$="1" THEN IF G=1 THEN 360 ELSE Q=I:GOTO 250
140 IF R$="4" THEN X=X-4:I=I-1 ELSE IF R$="6" THEN X=X+4:I=I+1 ELSE IF R$=CHR$(13) AND G=0 THEN 170 ELSE IF R$=CHR$(13) AND G=1 THEN 190 ELSE 130
150 IF X=5 THEN X=32:I=7 ELSE IF X=36 THEN X=9:I=1 ELSE IF X=25 THEN X=24 ELSE IF X=20 THEN X=21
160 LOCATE 4,Z:PRINT " ":GOTO 120
170 FOR J=1 TO 6:IF T(I,J)=0 THEN C=56+30*(I-1):L=197-27*J:GOSUB 1400:T(I,J)=1:G=1:U=C:O=L:E=I:R=J:GOTO 110
180 NEXT J:GOTO 120
190 FOR J=1 TO 6:IF T(I,J)=0 THEN C=56+30*(I-1):L=197-27*J:GOSUB 1300:T(I,J)=2:G=0:U=C:O=L:E=I:R=J:GOTO 100
200 NEXT J:GOTO 120
210 IF T(E,R)=0 THEN 130 ELSE IF G=0 THEN 230
220 PAINT (U+7,O+7),0,3:G=0:T(E,R)=0:GOTO 100
230 PAINT (U+7,O+7),0,3:G=1:T(E,R)=0:GOTO 110
240 REM ----------1 JOUEUR---------
250 PUT (1,1),A,PSET:I=Q
255 FOR P=1 TO 7:IF T(P,6)=0 THEN 260 ELSE NEXT P:PRINT "EGALITE...":END
260 LOCATE 4,X:PRINT CHR$(25):Z=X
270 R$=INKEY$:IF R$="Q" OR R$="q" THEN END ELSE IF R$="2" THEN G=0:GOTO 100
280 IF R$="4" THEN X=X-4:I=I-1 ELSE IF R$="6" THEN X=X+4:I=I+1 ELSE IF R$=CHR$(13) THEN 310 ELSE 270
290 IF X=5 THEN X=32:I=7 ELSE IF X=36 THEN X=9:I=1 ELSE IF X=25 THEN X=24 ELSE IF X=20 THEN X=21
300 LOCATE 4,Z:PRINT " ":GOTO 260
310 FOR J=1 TO 6:IF T(I,J)=0 THEN C=56+30*(I-1):L=197-27*J:GOSUB 1400:T(I,J)=1:G=1:U=C:O=L:E=I:R=J:GOTO 350
320 NEXT J:GOTO 260
330 IF T(I,J)=0 THEN 360
340 PUT (U,O),A:G=0:T(I,J)=0:GOTO 260
350 R$=INPUT$(1):IF R$="E" OR R$="e" THEN 330
355 REM -----------COMPUTER-----------
360 PUT (1,1),B,PSET:Q=I
370 I=E:J=R:GOSUB 520:IF GG>=4 THEN 1600
380 FOR P=1 TO 7:IF T(P,6)=0 THEN 390 ELSE NEXT P:BEEP:PRINT "EGALITE":END
390 FOR I=1 TO 7:FOR J=1 TO 6:IF T(I,J)<>0 THEN 410
400 GOSUB 760:IF GG>=4 THEN 1500 ELSE 411
410 NEXT J
411 NEXT I
420 FOR I=1 TO 7:FOR J=1 TO 6:IF T(I,J)<>0 THEN 440
430 GOSUB 520:IF GG>=4 THEN A=I:B=J:GOTO 490 ELSE 441
440 NEXT J
441 NEXT I
450 FOR A=1 TO 7:FOR B=1 TO 6:IF T(A,B)<>0 THEN 475
460 GOSUB 1020:IF GG<>3 THEN 480 ELSE IF B=6 THEN 490
470 GOSUB 500:GOTO 480
475 NEXT B
480 NEXT A
481 N=0
482 A=INT(RND*7)+1:FOR B=1 TO 6:IF T(A,B)=0 THEN 485
483 NEXT B
484 GOTO 482
485 N=N+1:IF N=20 THEN 490 ELSE IF B=6 THEN 490
486 I=A:J=B+1:GOSUB 520:IF GG>=4 THEN 482
490 C=56+30*(A-1):L=197-27*B:GOSUB 1300:T(A,B)=2:GOTO 250
500 I=A:J=B+1:GOSUB 520:IF GG<>4 THEN 490
510 RETURN
515 REM -------------VERIFICATION 1---------------
520 GG=1:FOR P=1 TO 3:IF I+P=8 THEN 550
530 IF T(I+P,J)<>1 THEN 550
540 GG=GG+1:IF GG>=4 THEN RETURN
545 NEXT P
550 FOR P=1 TO 3:IF I-P=0 THEN 580
560 IF T(I-P,J)<>1 THEN 580
570 GG=GG+1:IF GG>=4 THEN RETURN
575 NEXT P
580 GG=1:FOR P=1 TO 3:IF J+P=7 THEN 610
590 IF T(I,J+P)<>1 THEN 610
600 GG=GG+1:IF GG>=4 THEN RETURN
605 NEXT P
610 FOR P=1 TO 3:IF J-P=0 THEN 640
620 IF T(I,J-P)<>1 THEN 640
630 GG=GG+1:IF GG>=4 THEN RETURN
635 NEXT P
640 GG=1:FOR P=1 TO 3:IF I+P=8 OR J+P=7 THEN 670
650 IF T(I+P,J+P)<>1 THEN 670
660 GG=GG+1:IF GG>=4 THEN RETURN
665 NEXT P
670 FOR P=1 TO 3:IF I-P=0 OR J-P=0 THEN 700
680 IF T(I-P,J-P)<>1 THEN 700
690 GG=GG+1:IF GG>=4 THEN RETURN
695 NEXT P
700 GG=1:FOR P=1 TO 3:IF I-P=0 OR J+P=7 THEN 730
710 IF T(I-P,J+P)<>1 THEN 730
720 GG=GG+1:IF GG>=4 THEN RETURN
725 NEXT P
730 FOR P=1 TO 3:IF I+P=8 OR J-P=0 THEN RETURN
740 IF T(I+P,J-P)<>1 THEN RETURN
750 GG=GG+1:NEXT P:RETURN
755 REM ---------------VERIFICATION 2-----------------
760 GG=1:FOR P=1 TO 3:IF I+P=8 THEN 790
770 IF T(I+P,J)<>2 THEN 790
780 GG=GG+1:IF GG>=4 THEN RETURN
785 NEXT P
790 FOR P=1 TO 3:IF I-P=0 THEN 820
800 IF T(I-P,J)<>2 THEN 820
810 GG=GG+1:IF GG>=4 THEN RETURN
815 NEXT P
820 GG=1:FOR P=1 TO 3:IF J+P=7 THEN 850
830 IF T(I,J+P)<>2 THEN 850
840 GG=GG+1:IF GG>=4 THEN RETURN
845 NEXT P
850 FOR P=1 TO 3:IF J-P=0 THEN 880
860 IF T(I,J-P)<>2 THEN 880
870 GG=GG+1:IF GG>=4 THEN RETURN
875 NEXT P
880 GG=1:FOR P=1 TO 3:IF I+P=8 OR J+P=7 THEN 910
890 IF T(I+P,J+P)<>2 THEN 910
900 GG=GG+1:IF GG>=4 THEN RETURN
905 NEXT P
910 FOR P=1 TO 3:IF I-P=0 OR J-P=0 THEN 940
920 IF T(I-P,J-P)<>2 THEN 940
930 GG=GG+1:IF GG>=4 THEN RETURN
935 NEXT P
940 GG=1:FOR P=1 TO 3:IF I-P=0 OR J+P=7 THEN 970
950 IF T(I-P,J+P)<>2 THEN 970
960 GG=GG+1:IF GG>=4 THEN RETURN
965 NEXT P
970 FOR P=1 TO 3:IF I+P=8 OR J-P=0 THEN RETURN
980 IF T(I+P,J-P)<>2 THEN RETURN
990 GG=GG+1:NEXT P:RETURN
1010 REM ---------------VERIFICATION 3-----------------
1020 GG=1:FOR P=1 TO 2:IF A+P=8 THEN 1050
1030 IF T(A+P,B)<>1 THEN 1050
1040 GG=GG+1:IF GG=3 THEN RETURN
1045 NEXT P
1050 FOR P=1 TO 2:IF A-P=0 THEN 1080
1060 IF T(A-P,B)<>1 THEN 1080
1070 GG=GG+1:IF GG=3 THEN RETURN
1075 NEXT P
1080 GG=1:FOR P=1 TO 2:IF B+P=7 THEN 1110
1090 IF T(A,B+P)<>1 THEN 1110
1100 GG=GG+1:IF GG=3 THEN RETURN
1105 NEXT P
1110 FOR P=1 TO 2:IF B-P=0 THEN 1140
1120 IF T(A,B-P)<>1 THEN 1140
1130 GG=GG+1:IF GG=3 THEN RETURN
1135 NEXT P
1140 GG=1:FOR P=1 TO 2:IF A+P=8 OR B+P=7 THEN 1170
1150 IF T(A+P,B+P)<>1 THEN 1170
1160 GG=GG+1:IF GG=3 THEN RETURN
1165 NEXT P
1170 FOR P=1 TO 2:IF A-P=0 OR B-P=0 THEN 1200
1180 IF T(A-P,B-P)<>1 THEN 1200
1190 GG=GG+1:IF GG=3 THEN RETURN
1195 NEXT P
1200 GG=1:FOR P=1 TO 2:IF A-P=0 OR B+P=7 THEN 1230
1210 IF T(A-P,B+P)<>1 THEN 1230
1220 GG=GG+1:IF GG=3 THEN RETURN
1225 NEXT P
1230 FOR P=1 TO 2:IF A+P=8 OR B-P=0 THEN RETURN
1240 IF T(A+P,B-P)<>1 THEN RETURN
1250 GG=GG+1:NEXT P:RETURN
1300 PUT (C,9),B:FOR F=1 TO 90:NEXT F:PUT (C,9),B
1310 FOR F=9 TO L STEP 8:PUT (C,F),B:PUT (C,F),B:NEXT F
1320 SOUND 1000,.1:PUT (C,L-5),B:FOR F=1 TO 50:NEXT F
1330 PUT (C,L-5),B:PUT (C,L-7),B:FOR F=1 TO 50:NEXT F:PUT (C,L-7),B
1340 SOUND 1000,.1:PUT (C,L),B:RETURN
1400 PUT (C,9),A:FOR F=1 TO 90:NEXT F:PUT (C,9),A
1410 FOR F=9 TO L STEP 8:PUT (C,F),A:PUT (C,F),A:NEXT F
1420 SOUND 1000,.1:PUT (C,L-5),A:FOR F=1 TO 50:NEXT F
1430 PUT (C,L-5),A:PUT (C,L-7),A:FOR F=1 TO 50:NEXT F:PUT (C,L-7),A
1440 SOUND 1000,.1:PUT (C,L),A:RETURN
1500 C=56+30*(I-1):L=197-27*J:GOSUB 1300:BEEP:PRINT "JE GAGNE!":END
1600 BEEP:PRINT "TU GAGNES!"
